# BTC Dominance - Top 20 Altcoin Weights

## Project Goal

This project fetches historical weekly market capitalization data for the top 20 cryptocurrencies (excluding BTC and major stablecoins) relative to Bitcoin's market cap. It calculates the relative weight of each altcoin within this top 20 cohort for each weekly snapshot.

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd btc_dom_index
    ```
2.  **Create a virtual environment:** (Recommended)
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```
3.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
4.  **Configure API Key:**
    This script requires an API key from [CryptoCompare](https://min-api.cryptocompare.com/). It's **strongly recommended** to *not* hardcode the API key directly in `main.py`. Instead, use an environment variable:
    *   Set an environment variable named `CRYPTOCOMPARE_API_KEY`.
    *   Modify `main.py` to read this variable (e.g., using `os.getenv('CRYPTOCOMPARE_API_KEY')`).

    Alternatively, you could use a configuration file (e.g., `.env` or `config.ini`) and ensure it's added to `.gitignore`.

## Configuration Parameters (in `main.py`)

The following parameters can be adjusted at the top of `main.py`:

*   `LIMIT`: Number of coins to fetch per API call (default: 100).
*   `TSYM`: The currency to denominate market cap in (default: "BTC").
*   `START`: The start date and time for fetching data.
*   `END`: The end date and time for fetching data.
*   The list of symbols to exclude (currently hardcoded in the `to_dataframe` function). Consider moving this to a constant at the top for easier modification.

## Usage

Ensure your environment is set up and the API key is configured. Then run the script:

```bash
python main.py
```

The script will iterate through the specified date range, fetching data weekly, and print progress. A 1-second delay is included between API calls to respect free-tier limits.

## Output

The script generates a CSV file named `btcdom_top20_weights.csv` in the project root directory. This file contains the following columns:

*   `sym`: Cryptocurrency symbol.
*   `mcap_btc`: Market capitalization denominated in BTC.
*   `weight`: The relative weight of the coin's market cap within the top 20 for that snapshot.
*   `price_usd`: USD price of the cryptocurrency at the snapshot time
*   `rebalance_ts`: The timestamp (UTC) of the weekly snapshot.

This output file is generated by the script and is configured to be ignored by Git .
## Improvement Plan

*   Added a USD price column to `btcdom_top20_weights.csv` by calculating token prices in USD from their BTC price and the historical BTC/USD exchange rate retrieved from the API.

### Consequences

*   The CSV output now includes an additional column for USD prices, increasing file size and complexity.
*   Relies on the availability of historical BTC/USD data; missing data may result in null USD price values.
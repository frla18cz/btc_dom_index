# Project Improvement Plan: BTC Dominance - Top 20 Altcoin Weights

This document outlines the plan to improve the project's structure and documentation for better clarity, maintainability, and understanding by future LLMs and developers.

## 1. Create `README.md`

A new `README.md` file will be created with the following content:

```markdown
# BTC Dominance - Top 20 Altcoin Weights

## Project Goal

This project fetches historical weekly market capitalization data for the top 20 cryptocurrencies (excluding BTC and major stablecoins) relative to Bitcoin's market cap. It calculates the relative weight of each altcoin within this top 20 cohort for each weekly snapshot.

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <repository_url>
    cd btc_dom_index
    ```
2.  **Create a virtual environment:** (Recommended)
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```
3.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
4.  **Configure API Key:**
    This script requires an API key from [CryptoCompare](https://min-api.cryptocompare.com/). It's **strongly recommended** to *not* hardcode the API key directly in `main.py`. Instead, use an environment variable:
    *   Set an environment variable named `CRYPTOCOMPARE_API_KEY`.
    *   Modify `main.py` to read this variable (e.g., using `os.getenv('CRYPTOCOMPARE_API_KEY')`).

    Alternatively, you could use a configuration file (e.g., `.env` or `config.ini`) and ensure it's added to `.gitignore`.

## Configuration Parameters (in `main.py`)

The following parameters can be adjusted at the top of `main.py`:

*   `LIMIT`: Number of coins to fetch per API call (default: 100).
*   `TSYM`: The currency to denominate market cap in (default: "BTC").
*   `START`: The start date and time for fetching data.
*   `END`: The end date and time for fetching data.
*   The list of symbols to exclude (currently hardcoded in the `to_dataframe` function). Consider moving this to a constant at the top for easier modification.

## Usage

Ensure your environment is set up and the API key is configured. Then run the script:

```bash
python main.py
```

The script will iterate through the specified date range, fetching data weekly, and print progress. A 1-second delay is included between API calls to respect free-tier limits.

## Output

The script generates a CSV file named `btcdom_top20_weights.csv` in the project root directory. This file contains the following columns:

*   `sym`: Cryptocurrency symbol.
*   `mcap_btc`: Market capitalization denominated in BTC.
*   `weight`: The relative weight of the coin's market cap within the top 20 for that snapshot.
*   `rebalance_ts`: The timestamp (UTC) of the weekly snapshot.

This output file is generated by the script and is configured to be ignored by Git (see `.gitignore`).
```

## 2. Update `.gitignore`

The existing `.gitignore` file will be overwritten with standard Python ignores and include the generated output file:

```gitignore
# Byte-compiled / optimized / DLL files
__pycache__/
*.py[cod]
*$py.class

# C extensions
*.so

# Distribution / packaging
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
pip-wheel-metadata/
share/python-wheels/
*.egg-info/
.installed.cfg
*.egg
MANIFEST

# PyInstaller
# Usually these files are written by a python script from a template
# before PyInstaller builds the exe, so as to inject date/other infos into it.
*.manifest
*.spec

# Installer logs
pip-log.txt
pip-delete-this-directory.txt

# Unit test / coverage reports
htmlcov/
.tox/
.nox/
.coverage
.coverage.*
.cache
nosetests.xml
coverage.xml
*.cover
*.py,cover
.hypothesis/
.pytest_cache/

# Translations
*.mo
*.pot

# Django stuff:
*.log
local_settings.py
db.sqlite3
db.sqlite3-journal

# Flask stuff:
instance/
.webassets-cache

# Scrapy stuff:
.scrapy

# Sphinx documentation
docs/_build/

# PyBuilder
target/

# Jupyter Notebook
.ipynb_checkpoints

# IPython
profile_default/
ipython_config.py

# pyenv
.python-version

# pipenv
# According to pypa/pipenv#598, it is recommended to include Pipfile.lock in version control.
# Pipfile.lock

# PEP 582; used by PDM, Flit and potentially other packaging tools.
__pypackages__/

# Celery stuff
celerybeat-schedule
celerybeat.pid

# SageMath parsed files
*.sage.py

# Environments
.env
.venv
env/
venv/
ENV/
env.bak/
venv.bak/

# Spyder project settings
.spyderproject
.spyproject

# Rope project settings
.ropeproject

# mkdocs documentation
/site

# mypy
.mypy_cache/
.dmypy.json
dmypy.json

# Pyre type checker
.pyre/

# pytype static analysis results
.pytype/

# Cython debug symbols
cython_debug/

# VS Code settings
.vscode/

# IDEA settings
.idea/

# Output file
btcdom_top20_weights.csv
```

## 3. Suggested `main.py` Refinements (To be done in Code Mode)

The following changes are recommended for `main.py` to improve maintainability and clarity:

*   **Externalize API Key:** Move the hardcoded `API_KEY` to an environment variable (e.g., `CRYPTOCOMPARE_API_KEY`) or a configuration file.
*   **Make Parameters Configurable:** Move hardcoded values like `START`, `END`, `LIMIT`, `TSYM`, and the list of excluded symbols to constants at the top of the file or load them from a configuration source.
*   **Add Docstrings:** Add standard Python docstrings to the `to_dataframe` and `fetch_top20` functions explaining their purpose, arguments, and return values.
*   **Standardize Language:** Translate comments and user-facing print statements to English for consistency.